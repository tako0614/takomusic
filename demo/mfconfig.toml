[project]
entry = "src/main.mf"
dist  = "dist"
out   = "out"
default_profile = "cli"

[profiles.miku]
backend = "miku-daw"
import_strategy = "manual"
# daw_exe  = "reaper"
# daw_args = ["-renderproject", "{project}"]
# daw_project = "reaper/song.rpp"
vsqx_out     = "dist/vocal.vsqx"
tempo_mid_out= "dist/tempo.mid"
render_out   = "out/mix.wav"

[profiles.cli]
backend = "headless"
vocal_cmd = ["node", "C:/tools/neutrino-run.js", "{musicxml}", "{vocal_wav}"]
midi_cmd  = ["C:/tools/bin/fluidsynth.exe", "-ni", "C:/tools/soundfont.sf2", "{mid}", "-F", "{band_wav}", "-r", "44100"]
# Mix vocal + band with FFmpeg (vocal slightly louder)
mix_cmd   = ["C:/tools/bin/ffmpeg.exe", "-i", "{vocal_wav}", "-i", "{band_wav}", "-filter_complex", "[0:a]volume=1.2[v];[1:a]volume=0.8[b];[v][b]amix=inputs=2:duration=longest", "-codec:a", "libmp3lame", "-qscale:a", "2", "{mix_wav}", "-y"]
musicxml_out = "dist/vocal.musicxml"
band_mid_out = "dist/band.mid"
render_out   = "out/mix.mp3"
